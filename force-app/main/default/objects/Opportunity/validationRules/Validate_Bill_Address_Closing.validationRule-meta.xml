<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Validate_Bill_Address_Closing</fullName>
    <active>true</active>
    <description>Cannot move opportunity into Closing if Billing Address is incomplete or missing</description>
    <errorConditionFormula>AND   (
NOT(OR( 
($Permission.Validation_Rule_Exemption), 
($Profile.Name=&quot;Order Operations Admin&quot;),
 $User.Id = $Label.Automated_Process_UserId 
)), 
   AND( 
    ISPICKVAL(Type, &quot;Revenue Opportunity&quot;), 
    ISBLANK( Reseller__c), 
    ISBLANK( Finance_Partner__c )) ,
  OR (   
    ISPICKVAL(StageName, &quot;Closing&quot;),
    ISPICKVAL(StageName, &quot;Ready to Ship&quot;) 
  ),
  OR (
    ISBLANK(  Account.BillingStreet),
    ISBLANK(  Account.BillingCity),
    ISBLANK(  Account.BillingPostalCode  ),
    ISBLANK( Account.BillingCountry),
    ISBLANK(  Account.Billing_Email__c )

))</errorConditionFormula>
    <errorMessage>The Billing information on the Account is incomplete or missing. Please update the billing contact, billing email, and the billing address under the Address Information section on the Account.</errorMessage>
</ValidationRule>
