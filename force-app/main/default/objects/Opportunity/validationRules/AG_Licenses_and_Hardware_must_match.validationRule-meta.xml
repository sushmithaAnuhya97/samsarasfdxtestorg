<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>AG_Licenses_and_Hardware_must_match</fullName>
    <active>false</active>
    <description>This rule makes sure that HW-AG24 only goes with LIC-AG2-ENT and HW-AG41 only goes with LIC-AG4-ENT.</description>
    <errorConditionFormula>AND( 
NOT($Permission.Validation_Rule_Exemption), 
$Profile.Name &lt;&gt; &quot;Order Operations Admin&quot;, 
$Profile.Name &lt;&gt; &quot;Samsara - Finance&quot;,
OR( 
AND(AG2_Unit_Count__c &gt;0 ,  AG4_License_Count__c &gt;0 ,  AG2_License_Count__c =0 ), 
AND( AG4_Unit_Count__c &gt;0 ,  AG2_License_Count__c &gt;0 ,  AG4_License_Count__c =0 ) 
), 
OR(
ISPICKVAL(StageName,&quot;Proposal&quot;),
ISPICKVAL(StageName,&quot;Decision&quot;),
ISPICKVAL(StageName,&quot;Purchase&quot;), 
ISPICKVAL(StageName,&quot;Closing&quot;)))</errorConditionFormula>
    <errorMessage>You are trying to move an opportunity to purchase with a mismatch between asset gateway licenses and hardware. HW-AG24 only goes with LIC-AG2-ENT and HW-AG41 only goes with LIC-AG4-ENT.</errorMessage>
</ValidationRule>
