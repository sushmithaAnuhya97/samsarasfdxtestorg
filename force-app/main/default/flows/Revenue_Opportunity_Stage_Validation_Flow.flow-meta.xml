<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>64.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>Enable_Stage_Validation</name>
        <label>Enable Stage Validation</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>MatchingRecordFound</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>StageValidationMatchingRec</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_through_Validation_By_pass_for_user_role</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_through_Validation_By_pass_for_user_role</targetReference>
        </connector>
    </assignments>
    <customErrors>
        <name>Throw_Decision_Error</name>
        <label>Throw Decision Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <customErrorMessages>
            <errorMessage>{!$Label.Revenue_Opportunity_Decision_Validation}</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>Throw_Incubate_Error</name>
        <label>Throw Incubate Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <customErrorMessages>
            <errorMessage>{!$Label.Revenue_Opportunity_Incubate_Validation}</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>Throw_Incubate_Error_For_Add_On_Opportunity</name>
        <label>Throw Incubate Error For Add On Opportunity</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <customErrorMessages>
            <errorMessage>{!$Label.Revenue_Opportunity_Incubate_Add_On_Validation}</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>Throw_Purchase_Error</name>
        <label>Throw Purchase Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <customErrorMessages>
            <errorMessage>{!$Label.Revenue_Opportunity_Purchase_Validation}</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>Throw_Qualified_Error</name>
        <label>Throw Qualified Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <customErrorMessages>
            <errorMessage>{!$Label.Revenue_Opportunity_Qualified_Validation}</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>Throw_Trial_Error</name>
        <label>Throw Trial Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <customErrorMessages>
            <errorMessage>{!$Label.Revenue_Opportunity_Trial_Validation}</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <decisions>
        <description>Checks if docusign validation is disabled. This is configured in 2 ways.
Disabled by Automation Setting - Stage Validation Docusign
Disabled if the Opportunity owner role copy contains &apos;AE1&apos;</description>
        <name>Check_Docusign_Disabled_For_Decision</name>
        <label>Check Docusign Disabled For Decision</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Get_Related_Docusign_Atleast_Signed_Records</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Docusign_Disabled_For_Decision</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>DocusignEnabled</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Is_Stage_Purchase</targetReference>
            </connector>
            <label>Docusign Disabled For Decision</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks if docusign validation is disabled. This is configured in 2 ways.
Disabled by Automation Setting - Stage Validation Docusign
Disabled if the Opportunity owner role copy contains &apos;AE1&apos;</description>
        <name>Check_Docusign_Disabled_for_Purchase</name>
        <label>Check Docusign Disabled for Purchase</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Get_Related_Docusign_Completed_Records</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Docusign_Disabled_for_Purchase</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>DocusignEnabled</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Get_Current_Quarter</targetReference>
            </connector>
            <label>Docusign Disabled for Purchase</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_for_Child_Trial_Opportunities</name>
        <label>Check for Child Trial Opportunities</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Qualified_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Trials and Not Submitted for Approval</defaultConnectorLabel>
        <rules>
            <name>Has_Child_Trials</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Child_Trial_Opportunities</leftValueReference>
                <operator>IsEmpty</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Iterate_Over_Child_Trials</targetReference>
            </connector>
            <label>Has Child Trials</label>
        </rules>
        <rules>
            <name>No_Trials_and_Primary_Quote_Submitted_for_Approval</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.Primary_Quote_Status__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>LETS GO</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Primary_Quote_Status__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Approval Pending</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Stage_Trial</targetReference>
            </connector>
            <label>No Trials and Primary Quote Submitted for Approval</label>
        </rules>
    </decisions>
    <decisions>
        <description>As part of the GTMS-27945, adding requirements to move Stage from the below to forward.</description>
        <name>Check_for_Validation_Enabled_Statuses</name>
        <label>Check for Validation Enabled Statuses</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnectorLabel>Not within Validation Stages</defaultConnectorLabel>
        <rules>
            <name>Stage_Within_List</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Incubate</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Qualified</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Trial</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Decision</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Purchase</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Toggle_for_Docusign</targetReference>
            </connector>
            <label>Stage Within List</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_Docusign_Signed</name>
        <label>Check if Docusign Signed</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Log_Decision_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Docusign Signed</defaultConnectorLabel>
        <rules>
            <name>Docusign_Signed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Related_Docusign_Atleast_Signed_Records</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Stage_Purchase</targetReference>
            </connector>
            <label>Docusign Signed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_Trial_Has_Kick_Off_Date</name>
        <label>Check if Trial Has Kick Off Date</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Log_Qualified_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Kick off Date</defaultConnectorLabel>
        <rules>
            <name>Has_Kick_off_Date</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Iterate_Over_Child_Trials.Trial_Start_Date_new__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Iterate_Over_Child_Trials</targetReference>
            </connector>
            <label>Has Kick off Date</label>
        </rules>
    </decisions>
    <decisions>
        <description>Checks user&apos;s custom permissions as well as the Global Automation settings to check if the validations are by-passed or not. Also, skip the validation if the opportunity is created before the validation enforced date.</description>
        <name>Check_if_Validation_by_Passed</name>
        <label>Check if Validation by Passed</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Check_for_Validation_Enabled_Statuses</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Validation Enforced</defaultConnectorLabel>
        <rules>
            <name>Validation_By_Passed</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Permission.Validation_Rule_Exemption</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Permission.Validation_Exemption_Opportunity</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Setup.Global_Automation_Settings__c.Skip_Validation_Rule__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CreatedDate</leftValueReference>
                <operator>LessThan</operator>
                <rightValue>
                    <elementReference>Validation_Enforced_Date</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Validation_Enabled</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <label>Validation By-Passed</label>
        </rules>
    </decisions>
    <decisions>
        <description>Has Additional Validations, split the validations into 2 parts, first direct fields and then the related data, this condition only checks the validation on direct fields.</description>
        <name>Check_Qualified_Validation</name>
        <label>Check Qualified Validation</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Log_Qualified_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Qualified Validation Failed</defaultConnectorLabel>
        <rules>
            <name>Qualified_Validation_Success</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Product_Count__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.SBQQ__PrimaryQuote__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Child_Trial_Opportunities</targetReference>
            </connector>
            <label>Qualified Validation Success</label>
        </rules>
    </decisions>
    <decisions>
        <name>Close_Date_in_this_Quarter</name>
        <label>Close Date in this Quarter</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Log_Purchase_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not in Quarter</defaultConnectorLabel>
        <rules>
            <name>Close_Date_in_Qurater</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Current_Quarter</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <label>Close Date in Qurater</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check if there is atleast one Completed Docusign record</description>
        <name>Has_Completed_Docusign</name>
        <label>Has Completed Docusign?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Log_Purchase_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Completed Docusign</defaultConnectorLabel>
        <rules>
            <name>Completed_Docusign_Exists</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Related_Docusign_Completed_Records</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Current_Quarter</targetReference>
            </connector>
            <label>Completed Docusign Exists</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check if the Validations provided as part of GTMS-28358 for Incubate are passed or not.
As part of GTMS-28681, BANT fields must be excluded from Validation.
When Not an Add-On Opportunity all 4 fields must be filled.
When an Add-On Opportunity BANT fields are skipped, Related Contact &amp; Close Date must be filled.

For Amendment, Renewal &amp; Webstore Opportunities, skip the Need &amp; Budget Confirmed field validation</description>
        <name>Incubate_Validation</name>
        <label>Incubate Validation</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Is_Stage_Qualified</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Validation Passed</defaultConnectorLabel>
        <rules>
            <name>Validation_Failed</name>
            <conditionLogic>((1 OR 6 OR 7) AND (2 OR 3 OR 4 OR 5)) OR (NOT(1 OR 6 OR 7) AND (4 OR 5))</conditionLogic>
            <conditions>
                <leftValueReference>$Record.SBQQ__AmendedContract__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Need__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Budget_Confirmed__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Related_Contact__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.CloseDate</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.SBQQ__RenewedContract__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Is_Webstore_Upsell_Opportunity__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_an_Add_On_Opportunity</targetReference>
            </connector>
            <label>Validation Failed</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_an_Add_On_Opportunity</name>
        <label>Is an Add-On Opportunity</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Log_Incubate_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Add_On</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.SBQQ__AmendedContract__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Log_Incubate_Error_for_Add_On</targetReference>
            </connector>
            <label>Add-On</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check if Primary Quote is Approved. Used the field Primary Quote Status formual field on Opportunity. If Approved, it has the string &apos;LETS GO&apos;</description>
        <name>Is_Primary_Quote_Approved</name>
        <label>Is Primary Quote Approved</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Log_Decision_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not Approved</defaultConnectorLabel>
        <rules>
            <name>Approved</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.Primary_Quote_Status__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>LETS GO</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_Docusign_Disabled_For_Decision</targetReference>
            </connector>
            <label>Approved</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Stage</name>
        <label>Is Stage Decision</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Moved_Forward_from_decision</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Purchase</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closing</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Is_Primary_Quote_Approved</targetReference>
            </connector>
            <label>Moved Forward from decision</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Stage_Purchase</name>
        <label>Is Stage Purchase</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Passed_Forward_Purchase</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closing</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Check_Docusign_Disabled_for_Purchase</targetReference>
            </connector>
            <label>Passed Forward Purchase</label>
        </rules>
    </decisions>
    <decisions>
        <description>The stage next to incubate is Qualified in the Sales Process for Standard RecordType. If the Stage has moved past the Qualified Stage, then check the Validations implemented on Stage as well.</description>
        <name>Is_Stage_Qualified</name>
        <label>Is Stage Qualified</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Moved_Forward_From_Qualified</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Trial</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Proposal</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Decision</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Purchase</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closing</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_Qualified_Validation</targetReference>
            </connector>
            <label>Moved Forward From Qualified</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Stage_Trial</name>
        <label>Is Stage Trial</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Passed_Forward_Trial</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Proposal</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Decision</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Purchase</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closing</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Primary_Quote_Approved_or_In_Review</targetReference>
            </connector>
            <label>Passed Forward Trial</label>
        </rules>
    </decisions>
    <decisions>
        <description>Validation must be in either of Purchase, Decision, Trial, Qualified or Incubate.</description>
        <name>Is_StageName_In_Validation_List</name>
        <label>Is StageName In Validation List</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Incubate</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Incubate</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Incubate_Validation</targetReference>
            </connector>
            <label>Incubate</label>
        </rules>
        <rules>
            <name>Qualified</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Qualified</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Incubate</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_Qualified_Validation</targetReference>
            </connector>
            <label>Qualified</label>
        </rules>
        <rules>
            <name>Trial</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Trial</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Incubate</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Qualified</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Primary_Quote_Approved_or_In_Review</targetReference>
            </connector>
            <label>Trial</label>
        </rules>
        <rules>
            <name>Decision</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Decision</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Incubate</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Qualified</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Trial</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Proposal</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Primary_Quote_Approved</targetReference>
            </connector>
            <label>Decision</label>
        </rules>
        <rules>
            <name>Purchase</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Purchase</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Incubate</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Qualified</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Trial</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Proposal</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <stringValue>Decision</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_Docusign_Disabled_for_Purchase</targetReference>
            </connector>
            <label>Purchase</label>
        </rules>
    </decisions>
    <decisions>
        <name>Owner_Role_Matches_for_Validation</name>
        <label>Owner Role Matches for Validation</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Loop_through_Validation_By_pass_for_user_role</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Matches_Validation</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Owner_Role_Copy__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>Loop_through_Validation_By_pass_for_user_role.Name</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Enable_Stage_Validation</targetReference>
            </connector>
            <label>Matches</label>
        </rules>
    </decisions>
    <decisions>
        <description>Check if Primary Quote is sent for approval. Used the field Primary Quote Status formual field on Opportunity. If Approved, field has the string &apos;LETS GO&apos; and if its submitted, field has the string &apos;Approval Pending&apos;</description>
        <name>Primary_Quote_Approved_or_In_Review</name>
        <label>Primary Quote Approved or In Review</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Log_Trial_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Not Approved or In Review</defaultConnectorLabel>
        <rules>
            <name>In_Primary_Quote_Approved_or_In_Review</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record__Prior.Primary_Quote_Status__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>LETS GO</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record__Prior.Primary_Quote_Status__c</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <stringValue>Approval Pending</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Is_Stage</targetReference>
            </connector>
            <label>In Primary Quote Approved or In Review</label>
        </rules>
    </decisions>
    <decisions>
        <name>User_Role_to_bypass_found</name>
        <label>User Role to bypass found</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Owner_Role_Matches_for_Validation</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Validation_Bypass_true</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>MatchingRecordFound</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_through_Validation_By_pass_for_user_role</targetReference>
            </connector>
            <label>Validation Enabled</label>
        </rules>
    </decisions>
    <description>Related Jiras: GTMS-28362, GTMS-28361, GTMS-28360, GTMS-28359, GTMS-28358
Logic: For the Opportunity stages Incubate, Qualified, Trial, Decision &amp; Purchase, add validation to make sure proper data is added before moving forward.</description>
    <environments>Default</environments>
    <formulas>
        <name>DocusignEnabled</name>
        <dataType>Boolean</dataType>
        <expression>If(  NOT({!MatchingRecordFound}), NOT({!Get_Toggle_for_Docusign.Disabled__c}), 
If ( {!Get_Toggle_for_Docusign.Disabled__c} &amp;&amp; {!StageValidationMatchingRec.Invert_Stage_Validation_Docusign__c}, true, 
If ( NOT({!Get_Toggle_for_Docusign.Disabled__c}) &amp;&amp; {!StageValidationMatchingRec.Invert_Stage_Validation_Docusign__c}, false, 
If ( {!Get_Toggle_for_Docusign.Disabled__c} &amp;&amp; NOT({!StageValidationMatchingRec.Invert_Stage_Validation_Docusign__c}), false,
If ( NOT({!Get_Toggle_for_Docusign.Disabled__c}) &amp;&amp; NOT({!StageValidationMatchingRec.Invert_Stage_Validation_Docusign__c}), true, false)
)
)
)
)</expression>
    </formulas>
    <formulas>
        <name>Serialized_Log_For_Decision</name>
        <dataType>String</dataType>
        <expression>&apos;{ &quot;recordId&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;,&quot;primaryObjectName&quot;:&quot;Opportunity&quot;,&quot;userTransactionId&quot;: &quot;&apos;+{!$User.Id}+&apos;&quot;,&quot;functionalityType&quot;:&quot;Revenue Opportunity Stage Validation Flow&quot;, &quot;functionalitySubType&quot;:&quot;Decision&quot;,&quot;logs&quot;:[{&quot;Exception_Type__c&quot;:&quot;Stage Validation&quot;,&quot;Message__c&quot;:&quot;&apos;+{!$Label.Revenue_Opportunity_Decision_Validation}+&apos;&quot;,&quot;Level__c&quot;:&quot;ERROR&quot;,&quot;RecordId__c&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;}],&quot;startTimeMillis&quot;:1678886400000 }&apos;</expression>
    </formulas>
    <formulas>
        <name>Serialized_Log_For_Incubate</name>
        <dataType>String</dataType>
        <expression>&apos;{ &quot;recordId&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;,&quot;primaryObjectName&quot;:&quot;Opportunity&quot;,&quot;userTransactionId&quot;: &quot;&apos;+{!$User.Id}+&apos;&quot;,&quot;functionalityType&quot;:&quot;Revenue Opportunity Stage Validation Flow&quot;, &quot;functionalitySubType&quot;:&quot;Incubate&quot;,&quot;logs&quot;:[{&quot;Exception_Type__c&quot;:&quot;Stage Validation&quot;,&quot;Message__c&quot;:&quot;&apos;+{!$Label.Revenue_Opportunity_Incubate_Validation}+&apos;&quot;,&quot;Level__c&quot;:&quot;ERROR&quot;,&quot;RecordId__c&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;}],&quot;startTimeMillis&quot;:1678886400000 }&apos;</expression>
    </formulas>
    <formulas>
        <name>Serialized_Log_For_Incubate_Add_On</name>
        <dataType>String</dataType>
        <expression>&apos;{ &quot;recordId&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;,&quot;primaryObjectName&quot;:&quot;Opportunity&quot;,&quot;userTransactionId&quot;: &quot;&apos;+{!$User.Id}+&apos;&quot;,&quot;functionalityType&quot;:&quot;Revenue Opportunity Stage Validation Flow&quot;, &quot;functionalitySubType&quot;:&quot;Incubate&quot;,&quot;logs&quot;:[{&quot;Exception_Type__c&quot;:&quot;Stage Validation&quot;,&quot;Message__c&quot;:&quot;&apos;+{!$Label.Revenue_Opportunity_Incubate_Add_On_Validation}+&apos;&quot;,&quot;Level__c&quot;:&quot;ERROR&quot;,&quot;RecordId__c&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;}],&quot;startTimeMillis&quot;:1678886400000 }&apos;</expression>
    </formulas>
    <formulas>
        <name>Serialized_Log_For_Purchase</name>
        <dataType>String</dataType>
        <expression>&apos;{ &quot;recordId&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;,&quot;primaryObjectName&quot;:&quot;Opportunity&quot;,&quot;userTransactionId&quot;: &quot;&apos;+{!$User.Id}+&apos;&quot;,&quot;functionalityType&quot;:&quot;Revenue Opportunity Stage Validation Flow&quot;, &quot;functionalitySubType&quot;:&quot;Purchase&quot;,&quot;logs&quot;:[{&quot;Exception_Type__c&quot;:&quot;Stage Validation&quot;,&quot;Message__c&quot;:&quot;The opportunity close date must be today &amp; must have a Docusign with Completed Status.&quot;,&quot;Level__c&quot;:&quot;ERROR&quot;,&quot;RecordId__c&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;}],&quot;startTimeMillis&quot;:1678886400000 }&apos;</expression>
    </formulas>
    <formulas>
        <name>Serialized_Log_For_Qualified</name>
        <dataType>String</dataType>
        <expression>&apos;{ &quot;recordId&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;,&quot;primaryObjectName&quot;:&quot;Opportunity&quot;,&quot;userTransactionId&quot;: &quot;&apos;+{!$User.Id}+&apos;&quot;,&quot;functionalityType&quot;:&quot;Revenue Opportunity Stage Validation Flow&quot;, &quot;functionalitySubType&quot;:&quot;Qualified&quot; ,&quot;logs&quot;:[{&quot;Exception_Type__c&quot;:&quot;Stage Validation&quot;,&quot;Message__c&quot;:&quot;&apos;+{!$Label.Revenue_Opportunity_Qualified_Validation}+&apos;&quot;,&quot;Level__c&quot;:&quot;ERROR&quot;,&quot;RecordId__c&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;}],&quot;startTimeMillis&quot;:1678886400000 }&apos;</expression>
    </formulas>
    <formulas>
        <name>Serialized_Log_For_Trial</name>
        <dataType>String</dataType>
        <expression>&apos;{ &quot;recordId&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;,&quot;primaryObjectName&quot;:&quot;Opportunity&quot;,&quot;userTransactionId&quot;: &quot;&apos;+{!$User.Id}+&apos;&quot;,&quot;functionalityType&quot;:&quot;Revenue Opportunity Stage Validation Flow&quot;, &quot;functionalitySubType&quot;:&quot;Trial&quot;,&quot;logs&quot;:[{&quot;Exception_Type__c&quot;:&quot;Stage Validation&quot;,&quot;Message__c&quot;:&quot;&apos;+{!$Label.Revenue_Opportunity_Trial_Validation}+&apos;&quot;,&quot;Level__c&quot;:&quot;ERROR&quot;,&quot;RecordId__c&quot;:&quot;&apos;+{!$Record.Id}+&apos;&quot;}],&quot;startTimeMillis&quot;:1678886400000 }&apos;</expression>
    </formulas>
    <formulas>
        <name>Today</name>
        <dataType>Date</dataType>
        <expression>TODAY()</expression>
    </formulas>
    <formulas>
        <name>Validation_Enabled</name>
        <dataType>Boolean</dataType>
        <expression>If(  NOT({!MatchingRecordFound}), NOT({!Stage_Validation_Automation_Settings.Disabled__c}), 
If ( {!Stage_Validation_Automation_Settings.Disabled__c} &amp;&amp; {!StageValidationMatchingRec.Invert_Stage_Validation__c}, true, 
If ( NOT({!Stage_Validation_Automation_Settings.Disabled__c}) &amp;&amp; {!StageValidationMatchingRec.Invert_Stage_Validation__c}, false, 
If ( {!Stage_Validation_Automation_Settings.Disabled__c} &amp;&amp; NOT({!StageValidationMatchingRec.Invert_Stage_Validation__c}), false,
If ( NOT({!Stage_Validation_Automation_Settings.Disabled__c}) &amp;&amp; NOT({!StageValidationMatchingRec.Invert_Stage_Validation__c}), true, false)
)
)
)
)</expression>
    </formulas>
    <formulas>
        <description>The date from which the validation is enforced. Data is stored in Custom Label. Date format is YYYY-MM-DD</description>
        <name>Validation_Enforced_Date</name>
        <dataType>Date</dataType>
        <expression>DATEVALUE({!$Label.Oppty_Stage_Validation_Date})</expression>
    </formulas>
    <interviewLabel>Revenue Opportunity Stage Validation Flow {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Revenue Opportunity Stage Validation Flow</label>
    <loops>
        <name>Iterate_Over_Child_Trials</name>
        <label>Iterate Over Child Trials</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <collectionReference>Get_Child_Trial_Opportunities</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_if_Trial_Has_Kick_Off_Date</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Is_Stage_Trial</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_through_Validation_By_pass_for_user_role</name>
        <label>Loop through Validation By pass for user role</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <collectionReference>User_Level_Settings</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>User_Role_to_bypass_found</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Check_if_Validation_by_Passed</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Log_Decision_Error</name>
        <label>Log Decision Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Throw_Decision_Error</targetReference>
        </connector>
        <inputAssignments>
            <field>Serialized_Logs__c</field>
            <value>
                <elementReference>Serialized_Log_For_Decision</elementReference>
            </value>
        </inputAssignments>
        <object>Log_Message__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Incubate_Error</name>
        <label>Log Incubate Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Throw_Incubate_Error</targetReference>
        </connector>
        <inputAssignments>
            <field>Serialized_Logs__c</field>
            <value>
                <elementReference>Serialized_Log_For_Incubate</elementReference>
            </value>
        </inputAssignments>
        <object>Log_Message__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Incubate_Error_for_Add_On</name>
        <label>Log Incubate Error for Add-On</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Throw_Incubate_Error_For_Add_On_Opportunity</targetReference>
        </connector>
        <inputAssignments>
            <field>Serialized_Logs__c</field>
            <value>
                <elementReference>Serialized_Log_For_Incubate_Add_On</elementReference>
            </value>
        </inputAssignments>
        <object>Log_Message__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Purchase_Error</name>
        <label>Log Purchase Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Throw_Purchase_Error</targetReference>
        </connector>
        <inputAssignments>
            <field>Serialized_Logs__c</field>
            <value>
                <elementReference>Serialized_Log_For_Purchase</elementReference>
            </value>
        </inputAssignments>
        <object>Log_Message__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Qualified_Error</name>
        <label>Log Qualified Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Throw_Qualified_Error</targetReference>
        </connector>
        <inputAssignments>
            <field>Serialized_Logs__c</field>
            <value>
                <elementReference>Serialized_Log_For_Qualified</elementReference>
            </value>
        </inputAssignments>
        <object>Log_Message__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Log_Trial_Error</name>
        <label>Log Trial Error</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Throw_Trial_Error</targetReference>
        </connector>
        <inputAssignments>
            <field>Serialized_Logs__c</field>
            <value>
                <elementReference>Serialized_Log_For_Trial</elementReference>
            </value>
        </inputAssignments>
        <object>Log_Message__e</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_Child_Trial_Opportunities</name>
        <label>Get Child Trial Opportunities</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_for_Child_Trial_Opportunities</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>TrialResolutionOppty__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Opportunity</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get the configured current Fiscal Quarter</description>
        <name>Get_Current_Quarter</name>
        <label>Get Current Quarter</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Close_Date_in_this_Quarter</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Type</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Quarter</stringValue>
            </value>
        </filters>
        <filters>
            <field>StartDate</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <elementReference>$Record.CloseDate</elementReference>
            </value>
        </filters>
        <filters>
            <field>EndDate</field>
            <operator>GreaterThanOrEqualTo</operator>
            <value>
                <elementReference>$Record.CloseDate</elementReference>
            </value>
        </filters>
        <filters>
            <field>EndDate</field>
            <operator>GreaterThanOrEqualTo</operator>
            <value>
                <elementReference>Today</elementReference>
            </value>
        </filters>
        <filters>
            <field>StartDate</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <elementReference>Today</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Period</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get related Docusign data whose envelope status is &apos;Sent&apos; or &apos;Completed&apos;. There must be at least one such record to proceed forward</description>
        <name>Get_Related_Docusign_Atleast_Signed_Records</name>
        <label>Get Related Docusign Atleast Signed Records</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_if_Docusign_Signed</targetReference>
        </connector>
        <filterLogic>1 AND (2 OR 3)</filterLogic>
        <filters>
            <field>dsfs__Opportunity__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>dsfs__Envelope_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Sent</stringValue>
            </value>
        </filters>
        <filters>
            <field>dsfs__Envelope_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>dsfs__DocuSign_Status__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Get related Docusign data whose envelope status is &apos;Completed. There must be at least one such record to proceed forward</description>
        <name>Get_Related_Docusign_Completed_Records</name>
        <label>Get Related Docusign Completed Records</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Has_Completed_Docusign</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>dsfs__Opportunity__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>dsfs__Envelope_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Completed</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>dsfs__DocuSign_Status__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Toggle_for_Docusign</name>
        <label>Get Toggle for Docusign</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Is_StageName_In_Validation_List</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Stage Validation Docusign</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Automation_Settings__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Stage_Validation_Automation_Settings</name>
        <label>Stage Validation Automation Settings</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>User_Level_Settings</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Name</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Stage Validation</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Automation_Settings__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>User_Level_Settings</name>
        <label>User Level Settings</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_through_Validation_By_pass_for_user_role</targetReference>
        </connector>
        <filterLogic>or</filterLogic>
        <filters>
            <field>Invert_Stage_Validation__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Invert_Stage_Validation_Docusign__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Oppty_Stage_Validation_Exempt__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Stage_Validation_Automation_Settings</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND 3 AND 4 AND 5 AND (6 OR 7 OR 8 OR 9 OR 10 OR 11)</filterLogic>
        <filters>
            <field>StageName</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Type</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Revenue Opportunity</stringValue>
            </value>
        </filters>
        <filters>
            <field>Is_Webstore_Upsell_Opportunity__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>SBQQ__RenewedContract__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Renewal__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>StageName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Qualified</stringValue>
            </value>
        </filters>
        <filters>
            <field>StageName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Trial</stringValue>
            </value>
        </filters>
        <filters>
            <field>StageName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Proposal</stringValue>
            </value>
        </filters>
        <filters>
            <field>StageName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Decision</stringValue>
            </value>
        </filters>
        <filters>
            <field>StageName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Purchase</stringValue>
            </value>
        </filters>
        <filters>
            <field>StageName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Closing</stringValue>
            </value>
        </filters>
        <object>Opportunity</object>
        <recordTriggerType>Update</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>currentItem_Get_Validation_Enabled_Userrole_Record</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Oppty_Stage_Validation_Exempt__c</objectType>
    </variables>
    <variables>
        <name>MatchingRecordFound</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>StageValidationMatchingRec</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Oppty_Stage_Validation_Exempt__c</objectType>
    </variables>
    <variables>
        <description>Only considered when disabled in Automation Settings, if not, this is not considered</description>
        <name>ValidationEnabled</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
</Flow>
