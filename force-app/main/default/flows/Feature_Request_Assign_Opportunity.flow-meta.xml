<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>58.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>assign_Account_ids</name>
        <label>assign Account ids</label>
        <locationX>1050</locationX>
        <locationY>2060</locationY>
        <assignmentItems>
            <assignToReference>listOfAccountIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>loop_thru_related_accounts.Account__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_thru_related_accounts</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_opportunities</name>
        <label>assign opportunity</label>
        <locationX>768</locationX>
        <locationY>1514</locationY>
        <assignmentItems>
            <assignToReference>opportunityFR.Opportunity__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_thru_selected_opportunity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opportunityFR.AC_Idea__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>opportunityFRList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>opportunityFR</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_thru_selected_opportunity</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assigned_Account</name>
        <label>assigned Account</label>
        <locationX>945</locationX>
        <locationY>2330</locationY>
        <assignmentItems>
            <assignToReference>accountFR.Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_thru_oppty_records.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>accountFR.Feature_Request__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>accountFR.Is_Batch_Assign_Created__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>accountFRList</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>accountFR</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_thru_oppty_records</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>set_related_opportunity_id_exists</name>
        <label>set related opportunity id exists</label>
        <locationX>900</locationX>
        <locationY>998</locationY>
        <assignmentItems>
            <assignToReference>relatedOpportunityExists</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>check_for_related_records</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>set_related_opportunity_ids</name>
        <label>set related opportunity ids</label>
        <locationX>660</locationX>
        <locationY>614</locationY>
        <assignmentItems>
            <assignToReference>relatedOpportunityIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Look_thru_related_opportunities.Opportunity__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Look_thru_related_opportunities</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>set_selected_opportunity_exists</name>
        <label>set selected opportunity exists</label>
        <locationX>768</locationX>
        <locationY>1214</locationY>
        <assignmentItems>
            <assignToReference>relatedOpportunityExists</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>check_if_has_related_opportunity</targetReference>
        </connector>
    </assignments>
    <choices>
        <name>Account</name>
        <choiceText>Account</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Account</stringValue>
        </value>
    </choices>
    <choices>
        <name>Opportunity</name>
        <choiceText>Opportunity</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>Opportunity</stringValue>
        </value>
    </choices>
    <decisions>
        <name>check_Account_FR_List</name>
        <label>check Account FR List</label>
        <locationX>653</locationX>
        <locationY>2392</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>is_Account_FR_list_Has_Value</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>accountFRList</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Account_FR_Records</targetReference>
            </connector>
            <label>is Account FR list Has Value</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Current_Account</name>
        <label>Check Current Account</label>
        <locationX>927</locationX>
        <locationY>2146</locationY>
        <defaultConnector>
            <targetReference>assigned_Account</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>has_Account_Id</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>listOfAccountIds</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>loop_thru_oppty_records.AccountId</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>loop_thru_oppty_records</targetReference>
            </connector>
            <label>has Account Id</label>
        </rules>
    </decisions>
    <decisions>
        <name>check_for_related_records</name>
        <label>check for related records</label>
        <locationX>900</locationX>
        <locationY>1106</locationY>
        <defaultConnector>
            <targetReference>check_if_has_related_opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>has_related_records</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>relatedOpportunityIds</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>relatedOpportunityIds</leftValueReference>
                <operator>Contains</operator>
                <rightValue>
                    <elementReference>loop_thru_selected_opportunity</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>set_selected_opportunity_exists</targetReference>
            </connector>
            <label>has related records</label>
        </rules>
    </decisions>
    <decisions>
        <name>check_if_has_related_opportunity</name>
        <label>check if has related opportunity</label>
        <locationX>900</locationX>
        <locationY>1406</locationY>
        <defaultConnector>
            <targetReference>loop_thru_selected_opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>has_related_opportunity</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>relatedOpportunityIds</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>relatedOpportunityExists</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assign_opportunities</targetReference>
            </connector>
            <label>has related opportunity</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_If_Related_Opportunity_Has_Records</name>
        <label>Check If Related Opportunity Has Records</label>
        <locationX>680</locationX>
        <locationY>398</locationY>
        <defaultConnector>
            <targetReference>loop_thru_selected_opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>has_Records</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Related_Opportunities</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Look_thru_related_opportunities</targetReference>
            </connector>
            <label>has Records</label>
        </rules>
    </decisions>
    <decisions>
        <name>check_opportunity_list</name>
        <label>check opportunity list</label>
        <locationX>495</locationX>
        <locationY>1121</locationY>
        <defaultConnector>
            <targetReference>get_opportunity_records</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>opportunity_list_has_value</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>opportunityFRList</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>create_opportunity_FR_Records</targetReference>
            </connector>
            <label>opportunity list has value</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <interviewLabel>Feature Request Assign Opportunity {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Feature Request Assign Opportunity</label>
    <loops>
        <name>Look_thru_related_opportunities</name>
        <label>Look thru related opportunities</label>
        <locationX>572</locationX>
        <locationY>506</locationY>
        <collectionReference>Get_Related_Opportunities</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>set_related_opportunity_ids</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>loop_thru_selected_opportunity</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_thru_oppty_records</name>
        <label>loop thru oppty records</label>
        <locationX>680</locationX>
        <locationY>2057</locationY>
        <collectionReference>opptyRecords</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Check_Current_Account</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>check_Account_FR_List</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_thru_related_accounts</name>
        <label>loop thru related accounts</label>
        <locationX>1132</locationX>
        <locationY>1916</locationY>
        <collectionReference>get_related_accounts</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>assign_Account_ids</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>loop_thru_oppty_records</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_thru_selected_opportunity</name>
        <label>loop thru selected opportunity</label>
        <locationX>680</locationX>
        <locationY>890</locationY>
        <collectionReference>Select_Quote.recordIds</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>set_related_opportunity_id_exists</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>check_opportunity_list</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <recordCreates>
        <name>Create_Account_FR_Records</name>
        <label>Create Account FR Records</label>
        <locationX>548</locationX>
        <locationY>3014</locationY>
        <inputReference>accountFRList</inputReference>
    </recordCreates>
    <recordCreates>
        <name>create_opportunity_FR_Records</name>
        <label>create opportunity FR Records</label>
        <locationX>463</locationX>
        <locationY>1739</locationY>
        <connector>
            <targetReference>get_opportunity_records</targetReference>
        </connector>
        <inputReference>opportunityFRList</inputReference>
    </recordCreates>
    <recordLookups>
        <name>get_opportunity_records</name>
        <label>get opportunity records</label>
        <locationX>680</locationX>
        <locationY>1790</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>get_related_accounts</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>In</operator>
            <value>
                <elementReference>Select_Quote.recordIds</elementReference>
            </value>
        </filters>
        <object>Opportunity</object>
        <outputReference>opptyRecords</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>AccountId</queriedFields>
    </recordLookups>
    <recordLookups>
        <name>get_related_accounts</name>
        <label>get related accounts</label>
        <locationX>900</locationX>
        <locationY>1821</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>loop_thru_related_accounts</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Feature_Request__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Account_Idea_Assignment__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Related_Opportunities</name>
        <label>Get Related Opportunities</label>
        <locationX>680</locationX>
        <locationY>290</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_If_Related_Opportunity_Has_Records</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AC_Idea__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Opportunity_Idea_Assignment__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <runInMode>DefaultMode</runInMode>
    <screens>
        <name>Assign_Opportunity</name>
        <label>Assign Opportunity</label>
        <locationX>680</locationX>
        <locationY>182</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Get_Related_Opportunities</targetReference>
        </connector>
        <fields>
            <name>Select_Quote</name>
            <extensionName>flowruntime:lookup</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>objectApiName</name>
                <value>
                    <stringValue>SBQQ__Quote__c</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>label</name>
                <value>
                    <stringValue>Select Opportunity</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>fieldApiName</name>
                <value>
                    <stringValue>SBQQ__Opportunity2__c</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>maxValues</name>
                <value>
                    <numberValue>50.0</numberValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
            <styleProperties>
                <verticalAlignment>
                    <stringValue>top</stringValue>
                </verticalAlignment>
                <width>
                    <stringValue>12</stringValue>
                </width>
            </styleProperties>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>554</locationX>
        <locationY>48</locationY>
        <connector>
            <targetReference>Assign_Opportunity</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>accountFR</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account_Idea_Assignment__c</objectType>
    </variables>
    <variables>
        <name>accountFRList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Account_Idea_Assignment__c</objectType>
    </variables>
    <variables>
        <name>accountId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>currentOpptyAccountId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>listOfAccountIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>opportunityFR</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity_Idea_Assignment__c</objectType>
    </variables>
    <variables>
        <name>opportunityFRList</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity_Idea_Assignment__c</objectType>
    </variables>
    <variables>
        <name>opptyRecords</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Opportunity</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>relatedOpportunityExists</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>relatedOpportunityIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>relatedOpptyAccountIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
